/* Add to style.css */
.latex-output {
    font-size: 1.1rem;
    padding: 1rem;
    background: rgba(0,0,0,0.2);
    border-radius: 0.5rem;
    margin-bottom: 1rem;
    overflow-x: auto;
}

.step-card {
    border-left: 3px solid var(--btn2);
    padding-left: 1rem;
    margin-bottom: 1.5rem;
}

.step-title {
    font-weight: bold;
    color: var(--accent);
    margin-bottom: 0.5rem;
    display: block;
}

.warn-box {
    border: 1px solid #f59e0b;
    background: rgba(245, 158, 11, 0.1);
    color: #fcd34d;
    padding: 0.75rem;
    border-radius: 0.5rem;
    font-size: 0.9rem;
    margin: 1rem 0;
}

/* --- THEME ENGINE --- */
:root {
  --bg1:#2a0000; --bg2:#660000; --bg3:#b30000; --text:#ffeaea;
  --btn1:#7f1d1d; --btn2:#b91c1c; --ghost:#1a1a1a; 
  --card-border:rgba(255,255,255,.12); --card-bg:rgba(255,255,255,.04);
  --muted:#ffdede; --accent:#ffdddd;
  --success-bg: rgba(34, 197, 94, 0.1); --success-text: #4ade80;
  --warn-bg: rgba(245, 158, 11, 0.1); --warn-text: #fcd34d;
}
/* --- THEME DEFINITIONS --- */
[data-theme='blood-red'] { --bg1:#2a0000; --bg2:#660000; --bg3:#b30000; --text:#ffeaea; --card: rgba(255,255,255,0.03); --btn: linear-gradient(90deg,#7f1d1d,#b91c1c); --btn-hover: linear-gradient(90deg,#991b1b,#dc2626); }
[data-theme='sapphire-steel'] { --bg1:#0A2463; --bg2:#3E92CC; --bg3:#1E1E1E; --text:#F5F5F5; --card: rgba(255,255,255,0.05); --btn: linear-gradient(90deg,#0A2463,#3E92CC); --btn-hover: linear-gradient(90deg,#3E92CC,#5FA8D3); }
[data-theme='emerald-charcoal'] { --bg1:#1d3522; --bg2:#009B77; --bg3:#333333; --text:#E5E4E2; --card: rgba(255,255,255,0.05); --btn: linear-gradient(90deg,#009B77,#007f62); --btn-hover: linear-gradient(90deg,#00af88,#009B77); }
[data-theme='digital-twilight'] { --bg1:#1A1A2E; --bg2:#0F3460; --bg3:#16213E; --text:#C0C0C0; --card: rgba(233,69,96,0.05); --btn: linear-gradient(90deg,#E94560,#c73a50); --btn-hover: linear-gradient(90deg,#ff5c77,#E94560); }
[data-theme='coral-aqua'] { --bg1:#1A535C; --bg2:#4ECDC4; --bg3:#FF6B6B; --text:#F7FFF7; --card: rgba(26,83,92,0.4); --btn: linear-gradient(90deg,#FF6B6B,#ff8282); --btn-hover: linear-gradient(90deg,#ff9a9a,#FF6B6B); }
[data-theme='electric-citrus'] { --bg1:#7B2CBF; --bg2:#F7B801; --bg3:#560BAD; --text:#F1FAEE; --card: rgba(0,0,0,0.1); --btn: linear-gradient(90deg,#F7B801,#ffc93c); --btn-hover: linear-gradient(90deg,#ffd466,#F7B801); }
[data-theme='artisan-clay'] { --bg1:#3D405B; --bg2:#E07A5F; --bg3:#81B29A; --text:#F4F1DE; --card: rgba(61,64,91,0.4); --btn: linear-gradient(90deg,#E07A5F,#e68c75); --btn-hover: linear-gradient(90deg,#eb9d8a,#E07A5F); }
[data-theme='forest-canopy'] { --bg1:#1c3d30; --bg2:#2D6A4F; --bg3:#40916C; --text:#B7E4C7; --card: rgba(0,0,0,0.15); --btn: linear-gradient(90deg,#2D6A4F,#40916C); --btn-hover: linear-gradient(90deg,#52b788,#40916C); }
[data-theme='ocean-depth'] { --bg1:#001f23; --bg2:#003B46; --bg3:#07575B; --text:#C4DFE6; --card: rgba(102,165,173,0.1); --btn: linear-gradient(90deg,#07575B,#66A5AD); --btn-hover: linear-gradient(90deg,#66A5AD,#9ac3c9); }
[data-theme='desert-sunset'] { --bg1:#6D6875; --bg2:#B56576; --bg3:#E88873; --text:#FDE2E4; --card: rgba(0,0,0,0.1); --btn: linear-gradient(90deg,#B56576,#E88873); --btn-hover: linear-gradient(90deg,#c47c8c,#f09a87); }
[data-theme='monochrome-focus'] { --bg1:#000000; --bg2:#121212; --bg3:#222222; --text:#EAEAEA; --card: rgba(255,255,255,0.04); --btn: linear-gradient(90deg,#333,#555); --btn-hover: linear-gradient(90deg,#555,#777); }
[data-theme='soft-nordic'] { --bg1:#EDF2F4; --bg2:#8D99AE; --bg3:#D3D3D3; --text:#2B2D42; --card: rgba(255,255,255,0.4); --btn: linear-gradient(90deg,#D90429,#ef233c); --btn-hover: linear-gradient(90deg,#ef233c,#ff4d6d); }
[data-theme='neutral-peach'] { --bg1:#F5F5DC; --bg2:#F7CAC9; --bg3:#92A8D1; --text:#3E3E3E; --card: rgba(255,255,255,0.4); --btn: linear-gradient(90deg,#6B5B95,#8673b7); --btn-hover: linear-gradient(90deg,#8673b7,#a090d0); }
[data-theme='retro-pop'] { --bg1:#53777A; --bg2:#D95F43; --bg3:#C02942; --text:#ECD078; --card: rgba(0,0,0,0.1); --btn: linear-gradient(90deg,#D95F43,#C02942); --btn-hover: linear-gradient(90deg,#e0755a,#d1415a); }
[data-theme='cyberpunk-glow'] { --bg1:#0B0C10; --bg2:#1F2833; --bg3:#000000; --text:#66FCF1; --card: rgba(102,252,241,0.05); --btn: linear-gradient(90deg,#45A29E,#66FCF1); --btn-hover: linear-gradient(90deg,#66FCF1,#87ffff); }
[data-theme='plum-gold'] { --bg1:#230C33; --bg2:#4C2A85; --bg3:#000000; --text:#F7F7FF; --card: rgba(253,184,51,0.05); --btn: linear-gradient(90deg,#FDB833,#ffc966); --btn-hover: linear-gradient(90deg,#ffc966,#ffd488); }
[data-theme='red-blue'] { --bg1:#2b2d42; --bg2:#ef233c; --bg3:#3a86ff; --text:#ffffff; --card: rgba(0,0,0,0.1); --btn: linear-gradient(90deg,#ef233c,#3a86ff); --btn-hover: linear-gradient(90deg,#ff4d6d,#5c9cff); }
[data-theme='purple-black'] { --bg1:#000000; --bg2:#4c00b0; --bg3:#2c0065; --text:#e0d0ff; --card: rgba(255,255,255,0.04); --btn: linear-gradient(90deg,#8e44ad,#9b59b6); --btn-hover: linear-gradient(90deg,#9b59b6,#af7ac5); }
[data-theme='cat-noir'] {
    --bg1: #292826; /* A dark, near-black color from Cat Noir's suit */
    --bg2: #000000; /* A pure black for contrast, reflecting the "noir" theme */
    --bg3: #454440; /* A slightly lighter shade of black from his suit for depth */
    --text: #81e733; /* The vibrant green of Cat Noir's eyes and paw print icon */
    --card: rgba(129, 231, 51, 0.1); /* A translucent green for card elements, reminiscent of his Miraculous glow */
    --btn: linear-gradient(90deg, #81e733, #5cb85c); /* A green gradient for buttons, inspired by his powers */
    --btn-hover: linear-gradient(90deg, #5cb85c, #81e733); /* An inverted gradient for button hover effects */
}

body {
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, sans-serif;
  background: linear-gradient(135deg, var(--bg1), var(--bg2), var(--bg3));
  color: var(--text);
  -webkit-font-smoothing: antialiased;
  min-height: 100vh;
}

/* --- COMPONENTS --- */
.glass {
  background: var(--card-bg);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid var(--card-border);
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
}

.btn {
  padding: .6rem 1rem;
  border-radius: .6rem;
  font-weight: 600;
  transition: all .2s ease;
  font-size: 0.95rem;
  cursor: pointer;
}
.btn:active { transform: translateY(1px); }

.btn-primary {
  background: linear-gradient(90deg, var(--btn1), var(--btn2));
  color: #fff;
  box-shadow: 0 2px 10px rgba(0,0,0,0.2);
  border: none;
}
.btn-primary:hover { filter: brightness(1.1); }

.btn-ghost {
  background: var(--ghost);
  color: var(--text);
  border: 1px solid var(--card-border);
}
.btn-ghost:hover { background: rgba(255,255,255,0.1); }

.btn-link {
  background: transparent;
  border: 1px dashed var(--card-border);
  color: var(--muted);
  font-size: 0.85rem;
}
.btn-link:hover { border-color: var(--accent); color: var(--accent); }

.input {
  background: rgba(0, 0, 0, 0.2);
  border: 1px solid var(--card-border);
  padding: .75rem 1rem;
  border-radius: .5rem;
  color: var(--text);
  width: 100%;
  outline: none;
  transition: border-color 0.2s;
}
.input:focus { border-color: var(--accent); }

/* --- LAYOUT --- */
.grid-large {
  display: grid;
  gap: 1.5rem;
  grid-template-columns: 1fr;
}
@media(min-width: 980px) {
  .grid-large { grid-template-columns: 320px 1fr; }
}

.solid-divider {
  height: 1px;
  background: var(--card-border);
  margin: 1rem 0;
}

/* --- SPECIFIC UI ELEMENTS --- */
.nav-tab {
  font-size: 0.85rem;
  padding: 0.5rem;
  text-align: center;
  opacity: 0.8;
}
.nav-tab.active {
  background: var(--btn2);
  color: white;
  opacity: 1;
  border-color: var(--btn2);
}

/* Mathematical Output Styles */
.latex-output {
  font-size: 1.15rem;
  padding: 1.25rem;
  background: rgba(0,0,0,0.25);
  border-radius: 0.5rem;
  margin: 1rem 0;
  overflow-x: auto;
  border: 1px solid var(--card-border);
}

.step-card {
  border-left: 3px solid var(--btn2);
  padding-left: 1rem;
  margin-bottom: 1.5rem;
}

.step-title {
  font-weight: 700;
  color: var(--accent);
  display: block;
  margin-bottom: 0.4rem;
  text-transform: uppercase;
  font-size: 0.8rem;
  letter-spacing: 0.05em;
}

.warn-box {
  border: 1px solid var(--warn-text);
  background: var(--warn-bg);
  color: var(--warn-text);
  padding: 0.75rem;
  border-radius: 0.5rem;
  font-size: 0.9rem;
  margin: 1rem 0;
}

canvas {
  width: 100%;
  height: 250px;
  background: rgba(255,255,255,0.02);
  border-radius: 8px;
}

/* Scrollbar Customization */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 10px; }
::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.3); }
/* Force the notes section to ignore code-editor line breaks */
#content-notes, #content-notes div, #content-notes p {
    white-space: normal !important; 
}

/* Force MathJax to stay inline */
mjx-container[display="false"] {
    display: inline !important;
    margin: 0 !important;
}


.code-section-title {
    color: var(--accent);
    font-weight: bold;
    font-size: 1.1rem;
    margin-top: 1.5rem;
    margin-bottom: 0.5rem;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    padding-bottom: 0.25rem;
}

.code-label {
    display: block;
    font-size: 0.75rem;
    text-transform: uppercase;
    color: #888;
    margin-top: 1rem;
    margin-bottom: 0.25rem;
    letter-spacing: 0.05em;
}

.code-box {
    background: rgba(0,0,0,0.3);
    padding: 1rem;
    border-radius: 0.5rem;
    font-family: monospace;
    font-size: 0.9rem;
    color: #a7f3d0; /* Soft Green */
    overflow-x: auto;
    border: 1px solid rgba(255,255,255,0.05);
}

/* --- TREE DIAGRAM CSS --- */
.tree {
    overflow-x: auto;
    padding-bottom: 20px;
}

.tree ul {
    position: relative;
    padding-top: 20px; 
    display: flex;
    justify-content: center;
}

.tree li {
    position: relative;
    padding: 20px 5px 0 5px;
    text-align: center;
    list-style-type: none;
}

/* Connecting Lines */
.tree li::before, .tree li::after {
    content: '';
    position: absolute; 
    top: 0; 
    right: 50%;
    border-top: 2px solid rgba(255,255,255,0.2);
    width: 50%; 
    height: 20px;
}

.tree li::after {
    right: auto; 
    left: 50%;
    border-left: 2px solid rgba(255,255,255,0.2);
}

/* Remove connectors from single children */
.tree li:only-child::after, .tree li:only-child::before {
    display: none;
}
.tree li:only-child { padding-top: 0; }

/* Remove left connector from first child and right from last child */
.tree li:first-child::before, .tree li:last-child::after {
    border: 0 none;
}

/* Adding back the vertical connector to the last nodes */
.tree li:last-child::before{
    border-right: 2px solid rgba(255,255,255,0.2);
    border-radius: 0 5px 0 0;
}
.tree li:first-child::after{
    border-radius: 5px 0 0 0;
}

/* Downward connector from parents */
.tree ul ul::before{
    content: '';
    position: absolute; 
    top: 0; 
    left: 50%;
    border-left: 2px solid rgba(255,255,255,0.2);
    width: 0; 
    height: 20px;
}

/* The Node Styling */
.tree-node {
    display: inline-block;
    padding: 8px 12px;
    text-decoration: none;
    border-radius: 50%; /* Make circles */
    width: 40px;
    height: 40px;
    line-height: 24px;
    font-weight: bold;
    font-size: 14px;
    transition: all 0.3s;
    border: 1px solid rgba(255,255,255,0.2);
    background: rgba(0,0,0,0.3);
    color: #fff;
    position: relative;
    z-index: 10;
}

.tree-node.pivot {
    background: rgba(234, 179, 8, 0.2); /* Yellow */
    border-color: rgba(234, 179, 8, 0.8);
    color: #fce7f3;
}

.tree-node.leaf {
    background: rgba(59, 130, 246, 0.2); /* Blue */
    border-color: rgba(59, 130, 246, 0.8);
}

.tree-node.null {
    background: transparent;
    border: 1px dashed rgba(255,255,255,0.1);
    color: rgba(255,255,255,0.2);
    font-size: 10px;
    width: 30px;
    height: 30px;
    line-height: 15px;
}

/* Theme dropdown override */
#theme-dropdown {
    background-color: white !important;
    color: black !important;
    border: 1px solid #ccc;
    border-radius: 0.5rem;
    padding: 0.25rem 0.5rem;
    cursor: pointer;
    font-weight: 500;
}

#theme-dropdown option {
    color: black;
    background-color: white;
}


#theme-dropdown:focus {
    outline: none;
    border-color: var(--btn2); /* uses theme accent for focus */
    box-shadow: 0 0 5px rgba(0,0,0,0.2);
}
